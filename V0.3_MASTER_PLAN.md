# Harthio v0.3 - Master Implementation Plan

**Version:** v0.3 - AI Companion + Mental Health Focus  
**Current:** v0.2 (40 users)  
**Timeline:** Q1 2025 (12 weeks)  
**Target:** 500 users, 10% Pro conversion  
**Status:** Week 3-4 (UI Redesign Phase)

---

## ğŸ†• Recent Updates (Latest Session)

### **Mobile UX Improvements** ğŸ“±
- âœ… Mobile page header component created and implemented
- âœ… Logo component optimized (smaller text, compact BETA badge)
- âœ… Icon sizes increased for better touch targets (h-5 w-5)
- âœ… Text sizes standardized to Twitter/X standards:
  - Session titles: 17px (readable, clear hierarchy)
  - Body text: 15px (comfortable reading)
  - Metadata: 13px (compact but readable)
- âœ… "My Upcoming Sessions" renamed to "My Sessions" (cleaner)
- âœ… Search sheet simplified (removed filters, matches desktop)
- âœ… Requests sheet redesigned (cleaner, modern cards)

### **Database Fixes** ğŸ”§
- âœ… Fixed `filteredSessions` initialization bug (variable hoisting)
- âœ… Created `fix-topics-and-rpc.sql` migration:
  - Adds missing `updated_at` column to topics table
  - Creates `add_join_request_secure` function (what code calls)
  - Adds security validations (auth check, input validation, message length limit)
  - Idempotent (safe to run multiple times)
- âœ… Created `PRODUCTION_MIGRATIONS.md` - documents only 5 required migrations
- âš ï¸ Identified 20+ unused database files (need cleanup/archiving)

### **Discovered Issues** ğŸ›
- âŒ Database has many legacy/unused files (security-fixes, experimental features)
- âŒ Some files duplicate functionality already in combined.sql
- ğŸ“ Recommendation: Archive unused files to keep database/ folder clean

---

## ğŸ¯ Current Progress Summary

**âœ… COMPLETED (Week 1-6):**

### **Core Infrastructure**
- 5-tab navigation system (mobile + desktop)
- Database migrations with RLS security (daily_checkins, sobriety_trackers)
- Security hardening (all APIs with rate limiting, validation, OWASP compliance)
- Contact API secured
- Webpack cache management

### **Progress Page** ğŸ“Š
- 3 tabs: Tracker | History | Stats
- 7-day mood trend line chart (shows gaps, not punishing)
- Weekly insights (average mood, trend %, best/worst days)
- Weekly stats with achievement badges
- Session history integration
- Real data integration

### **Home Page Redesign** ğŸ  (Recovery-Focused)
- **Real-time sobriety counter**
  - Counts: Months, Days, Hours, Minutes, Seconds
  - Updates every second
  - Multiple tracker support (alcohol, smoking, drugs, gambling, other)
  - Swipeable cards with dots indicator
  - Milestone badges (âœ¨1 Day, ğŸŒŸ1 Week, ğŸ‰1 Month, ğŸ†90 Days, ğŸ‘‘1 Year)
  - Color-coded by type
  - Background visuals (Bridge/Phoenix/Mountain) - coming
  
- **Mood check-in** (kept simple)
  - 4 mood buttons (ğŸ˜¢ Struggling, ğŸ˜ Okay, ğŸ˜Š Good, ğŸš€ Great)
  - Last check-in indicator
  
- **Simplified motivational quotes**
  - 5 short, impactful quotes (down from 31 long ones)
  - Small, non-intrusive display
  
- **Intentionally Removed:**
  - âŒ Check-in streaks (too stressful, punishes missed days)
  - âŒ Sessions joined stat (belongs in Progress)
  - âŒ Manual tracker creation button (AI will handle)
  - âŒ Reset button (AI-guarded for safety)
  - âŒ Quick action buttons (reduces clutter)

**âœ… COMPLETED (Week 7):**
- **Contextual Check-in with Slide-down Input** ğŸ¯
  - Smart prompts based on mood selected (4 different prompts)
  - Optional note capture for context
  - Slide-down animation from top
  - Skip or save options
  - Builds data for AI pattern detection

**âœ… COMPLETED (Week 7):**
- **Unified Chat System** ğŸ’¬ (MAJOR ENHANCEMENT)
  - Single `ModernChatPanel` component for all chat needs
  - Supports two modes: `peer` (user-to-user) and `ai` (AI chat)
  - **Brand-Aligned Design:**
    - Uses Harthio logo for AI avatar (with pulse animation when thinking)
    - Warm Rose (primary) and Gentle Teal (accent) colors only
    - Soft Lavender backgrounds
    - No purple/pink gradients - pure brand colors
  - **Mobile-First Responsive:**
    - Mobile (< 768px): Full-screen bottom sheet, 85vh height
    - Tablet (768-1024px): 400px side panel
    - Desktop (> 1024px): 500px side panel
    - Larger touch targets (44px minimum)
    - Safe area insets for notched devices
    - Prevents zoom on iOS input focus
  - **Accessibility:**
    - Proper ARIA labels
    - Keyboard navigation (Enter to send)
    - Screen reader support
    - High contrast ratios
  - Used in both Session page and Harthio AI page
  - Consistent UX across the platform

- **Harthio AI Chat Interface** ğŸ’¬ (CORE v0.3 feature)
  - DeepSeek API integration
  - Conversational AI for 24/7 support
  - Crisis keyword detection with immediate resources
  - System prompt optimized for mental health support
  - Chat history with user/assistant messages
  - Real-time typing and responses
  - Mobile-responsive design
  - Uses unified ModernChatPanel component
  - Pro-tier ready (auth TODO documented)

- **AI-Guarded Tracker Reset** ğŸ†˜
  - Redirects to Harthio AI when reset clicked
  - Special conversation flow for relapse support
  - Crisis intervention at critical moment
  - Prevents impulsive decisions
  - Offers support before allowing reset
  - Reset button appears after conversation
  - Compassionate messaging (no judgment)

- **Contextual Check-in with Slide-down Input** ğŸ¯
  - Smart prompts based on mood selected (4 different prompts)
  - Optional note capture for context
  - Slide-down animation from top
  - Skip or save options
  - Builds data for AI pattern detection

**âœ… COMPLETED (Week 7 continued):**
- **AI-Powered Tracker Creation** ğŸ¤–
  - Conversational tracker setup via Harthio AI
  - Natural language processing for tracker type detection
  - Automatic start date extraction ("3 days ago", "yesterday", etc.)
  - Confirmation button before creation
  - Redirects from Home page "Add Tracker" button
  - Supports: alcohol, smoking, drugs, gambling, other
  - Smart intent detection with confidence scoring

**ğŸš§ IN PROGRESS (Week 7-8):**

**âœ… COMPLETED (Week 7 continued):**
- **Pattern Detection & Proactive Support** ğŸ”
  - Detects 3+ consecutive days of "struggling" check-ins
  - Automatic intervention toast notification
  - Redirects to Harthio AI with compassionate message
  - Special intervention conversation flow
  - Non-intrusive but supportive approach
  - Helps users before crisis escalates

**âœ… COMPLETED (Week 7 continued):**
- **CBT Tools Suite** ğŸ§  (World-Class Clinical Standard)
  - **Evidence-Based Techniques:**
    - Thought Challenger (Aaron Beck's CBT - Grade A evidence)
    - 4-4-6 Breathing (Neuroscience validated - Grade A)
    - 5-4-3-2-1 Grounding (DBT standard - Grade B)
    - Coping Techniques (Multiple validated interventions)
  - **Clinical Sequencing:** Validate â†’ Normalize â†’ Educate â†’ Offer â†’ Guide â†’ Check-in â†’ Escalate
  - **Smart Detection** - Keywords for anxiety, negative thoughts, cravings, stress
  - **Professional Disclaimers** - One-time notice, positively framed, non-intrusive
  - **Crisis Escalation** - Clear path to professional help if techniques don't work
  - **Industry Comparison** - Matches Headspace/Calm standards at lower price
  - **Full Documentation** - Clinical references, evidence levels, research support
  - **Pro Access Only** - Part of Harthio AI ($9.99/month vs $70+/year competitors)

**âœ… COMPLETED (Week 7 - ALL FEATURES DONE!):**
- **Visual Recovery Journey** ğŸŒ‰ (Gamification System)
  - **30-Piece System:** 1 piece unlocks every 3 days
  - **3-Phase Journey:** Bridge (0-90d) â†’ Phoenix (91-180d) â†’ Mountain (181-365d)
  - **Compassionate Relapse:** Tiered loss system (lose 0-3 pieces based on progress)
  - **Progress Tracking:** Previous best, total attempts, resilience score
  - **Comeback Badges:** Reward persistence and recovery
  - **Database:** Visual journey fields + relapse history table
  - **Service Functions:** Calculate pieces, relapse impact, next milestone

**ğŸš§ IN PROGRESS (Week 7-8):**

**â³ NEXT UP:**
- Pro tier subscription system (Stripe integration)
- Rate limiting for AI usage (free vs pro)
- Background images for visual journey (Bridge/Phoenix/Mountain photos)

**ğŸ“ TODO: AI API Authentication (Before Production)**
Location: `src/app/api/ai/chat/route.ts`

Currently has NO authentication for development. Before production:
1. Add authentication check (verify Supabase token)
2. Add Pro tier check (only Pro users can access AI)
3. Add rate limiting (prevent abuse)
4. Update client to send auth token in headers

See current code comments in the file for implementation details.

---

## ğŸ“‹ Table of Contents
1. [Vision & Strategy](#vision--strategy)
2. [Feature Specifications](#feature-specifications)
3. [Pricing Model](#pricing-model)
4. [Mobile-First Design](#mobile-first-design)
5. [Crisis Detection System](#crisis-detection-system)
6. [Implementation Timeline](#implementation-timeline)
7. [Success Metrics](#success-metrics)

---

## Vision & Strategy

### **Three-Tier Growth Model**
```
Tier 1: AI Companion (v0.3) â† Building Now
â”œâ”€ 24/7 AI support
â”œâ”€ CBT tools
â””â”€ Recovery tracking

Tier 2: Peer Sessions (Live) âœ…
â”œâ”€ Video/voice calls
â”œâ”€ Community support
â””â”€ 40 active users

Tier 3: Professional Therapy (v0.4) ğŸ”®
â”œâ”€ Licensed therapists
â”œâ”€ Insurance integration
â””â”€ Launch Q4 2025
```

### **Target Market**
1. **Primary:** Addiction recovery (alcohol, drugs, gambling)
2. **Secondary:** Mental health (anxiety, depression, PTSD)
3. **Tertiary:** General peer support

### **Positioning**
"Your complete recovery support system - AI when you need it, humans when you want it"

---

## Feature Specifications

### **1. Harthio AI Companion** ğŸ’¬
**What:** Conversational AI for 24/7 mental health support

**Capabilities:**
- Natural conversation about struggles
- Evidence-based CBT techniques
- Crisis detection & resources
- Smart session suggestions
- Recovery progress tracking

**Access:**
- Free: âŒ Not available
- Pro: âœ… Unlimited chat

**Example Conversation:**
```
User: "I'm having cravings tonight"

Harthio: "I'm here for you. Let's work through this:

1. ğŸ§  Challenge those thoughts (CBT)
2. ğŸ’ª Quick coping technique
3. ğŸ¯ Find support session
4. ğŸ“ Crisis resources

What would help most right now?"
```

---

### **2. AI Topic Helper** âœ¨
**What:** Helps users create better session topics

**How It Works:**
```
User: "struggling with staying sober at night"

Harthio: "I can help you create a session:

Title: Evening Sobriety Support
Description: Let's discuss strategies for staying 
sober during difficult evening hours. Share what 
works and learn from others.

[âœï¸ Edit] [âœ“ Create] [ğŸ”„ Try Again]"
```

**Access:**
- Free: 1 per day
- Pro: 10 per day

**Why Limited?**
- Prevents session spam
- Encourages thoughtful creation
- Keeps costs predictable

---

### **3. Contextual Daily Check-In** ğŸ“Š
**What:** Mood tracking with optional context capture

**New Flow (Implemented):**
```
User clicks: ğŸ˜Š Good

[Slide-down animation from top]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ That's great! ğŸ‰                   â”‚
â”‚ What made you feel good today?      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [Optional text input...]        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ [Skip] [Save]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[Slides up after save/skip]
```

**Smart Prompts Based on Mood:**
- ğŸ˜¢ Struggling: "What's making today tough? Want to talk?"
- ğŸ˜ Okay: "Anything on your mind today?"
- ğŸ˜Š Good: "What made you feel good today?"
- ğŸš€ Great: "That's amazing! What's going well?"

**Auto-Response for Crisis:**
```
User clicks: ğŸ˜¢ Struggling (3 days in a row)

Immediate actions:
ğŸ—£ï¸ Talk to Harthio AI
ğŸ“… Find support session
ğŸ“ Crisis resources
â­ï¸ Skip for now
```

**Access:**
- Free: âœ… Unlimited check-ins
- Pro: âœ… Unlimited + AI analysis of patterns

**Why This Matters:**
- Captures context, not just numbers
- Builds data for AI pattern detection
- Encourages reflection without pressure
- Optional (can skip)
- Crisis intervention at critical moments

---

### **4. CBT Tools Suite** ğŸ§ 
**What:** Evidence-based mental health techniques integrated into Harthio AI

**Tools (All Grade A/B Clinical Evidence):**
1. **ğŸ§  Thought Challenger** - Cognitive restructuring (Aaron Beck's CBT)
2. **ğŸŒŠ 4-4-6 Breathing** - Anxiety/panic relief (neuroscience validated)
3. **ğŸ¯ 5-4-3-2-1 Grounding** - Sensory awareness (DBT standard)
4. **ğŸ’ª Coping Techniques** - Cold water, PMR, visualization, movement

**Clinical Protocol:**
Validate â†’ Normalize â†’ Educate â†’ Offer â†’ Guide â†’ Check-in â†’ Escalate if needed

**Professional Standards:**
- One-time disclaimer (positively framed)
- Crisis escalation protocols
- Never diagnose/prescribe
- Matches Headspace/Calm standards

**Access:**
- Free: âŒ Not available
- Pro: âœ… Unlimited ($9.99/month vs competitors $70+/year)

---

### **5. Real-Time Sobriety Tracker** â±ï¸
**What:** Live countdown of recovery milestones with visual journey gamification

**Real-Time Counter:**
- Updates every second: Months, Days, Hours, Minutes, Seconds
- Multiple trackers: Alcohol, Smoking, Drugs, Gambling, Other
- Swipeable cards for multiple recovery goals
- Color-coded by type

**Visual Journey Gamification (30-Piece System):**
- **Phase 1 (Days 0-90): Building the Bridge** ğŸŒ‰
  - 30 pieces total, 1 piece unlocks every 3 days
  - Complete bridge = 90-day milestone
  
- **Phase 2 (Days 91-180): Phoenix Rising** ğŸ”¥
  - New 30-piece image starts
  - 1 piece every 3 days
  - Complete phoenix = 6-month milestone
  
- **Phase 3 (Days 181-365): Climbing the Mountain** â›°ï¸
  - New 30-piece image starts
  - 1 piece every 6 days (sl

**AI-Powered Management:**
```
Tracker Creation (via AI):
User: "I want to track my alcohol sobriety"
Harthio: "Great! When did you start? Today or a different date?"
User: "Started 3 days ago"
Harthio: "Done! Your 'Alcohol Free' tracker is live. 
You're 3 days strong! ğŸ’ª"

Tracker Reset (AI-Guarded):
User: "I need to reset my tracker"
Harthio: "I'm here for you. Can you tell me what happened?
You were 45 days strong - that's incredible progress.

Would you like to:
1. ğŸ—£ï¸ Talk about what led to this
2. ğŸ“ Connect with someone
3. ğŸ”„ Reset counter and start fresh
4. â¸ï¸ Take a moment before deciding"
```

**Why AI-Guarded Reset:**
- âœ… Crisis intervention moment
- âœ… Prevents impulsive decisions
- âœ… Offers immediate support
- âœ… Reduces shame around setbacks
- âœ… Connects to help resources
- âœ… Learns relapse triggers

**Access:**
- Free: âœ… Unlimited trackers with real-time counting
- Pro: âœ… Advanced analytics + AI pattern detection

**Security:**
- Row Level Security (RLS) enabled
- Users can only see/modify their own trackers
- Data encrypted and private

---

## Pricing Model

### **Free Tier**
```
âœ… Unlimited peer sessions
âœ… 1 AI Topic Helper per day
âœ… Unlimited daily check-ins
âœ… Basic recovery tracker
âœ… Crisis resources

âŒ No Harthio AI companion
âŒ No CBT tools
âŒ No advanced analytics
```

### **Pro Tier - $9.99/month**
```
âœ… Everything in Free, plus:
âœ… Unlimited Harthio AI companion â† Main Value!
âœ… 10 AI Topic Helpers per day
âœ… Full CBT tools suite
âœ… Advanced recovery tracker
âœ… Detailed progress analytics
âœ… Priority session matching
âœ… Export recovery data
âœ… Ad-free experience
```

### **Free Trial**
- **14 days** (not 7)
- Why? Mental health needs time to show impact
- Allows users to experience full value
- See real progress in recovery

### **Revenue Projections**
```
Current (v0.2): 40 users Ã— 0% = $0/month
v0.3 Launch: 500 users Ã— 10% = $500/month
v0.4 (therapy): Additional commission revenue
```

---

## Responsive Design Strategy

### **Screen Sizes**
```
Mobile:  < 768px  (sm)  - Bottom navigation (4 tabs)
Tablet:  768-1024px (md) - Sidebar navigation
Desktop: > 1024px (lg)   - Sidebar navigation
```

### **Mobile (< 768px) - Bottom Navigation**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ       ğŸ’¬        ğŸ“…        ğŸ“Š        ğŸ‘¤         â”‚
â”‚ Home  Harthio  Sessions  Progress    Me          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Fixed bottom bar (5 tabs)
- Content has `pb-16` padding to avoid overlap
- Compact icons for mobile

### **Tablet/Desktop (â‰¥ 768px) - Sidebar Navigation**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sidebar  â”‚  Main Content          â”‚
â”‚          â”‚                        â”‚
â”‚ Home     â”‚  Dashboard/Page        â”‚
â”‚ Harthio  â”‚                        â”‚
â”‚ Sessions â”‚                        â”‚
â”‚ Progress â”‚                        â”‚
â”‚ Requests â”‚                        â”‚
â”‚ Profile  â”‚                        â”‚
â”‚ History  â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Sidebar shows all navigation
- No bottom bar
- Full screen content

### **Implementation Status**
- âœ… Mobile bottom nav (5 tabs) - COMPLETED
- âœ… Responsive design (mobile + desktop) - COMPLETED
- âœ… Tab order: Progress | Harthio | Home | Sessions | Me - COMPLETED
- âœ… Home page with daily quotes - COMPLETED
- âœ… Daily check-in functionality - COMPLETED
- âœ… Progress page structure - COMPLETED
- âš ï¸ Need to implement: Recovery tracker visualization
- âš ï¸ Need to implement: Harthio AI chat
- âš ï¸ Need to implement: Real data integration

### **Tab 1: ğŸ“Š Progress** (First Position)
**Status: âœ… COMPLETED (Tracker & History), âš ï¸ Stats Pending**
- âœ… Recovery tracker with 7-day mood chart
- âœ… Weekly insights (trend, best/worst days)
- âœ… Session history with real data
- âœ… Quick stats cards (Current Streak, Total Check-ins, Sessions Joined)
- âœ… 3-tab layout: Tracker | History | Stats
- âš ï¸ Weekly stats - Placeholder ready

### **Tab 2: ğŸ’¬ Harthio** (AI Companion)
**Status: âš ï¸ Not Started**
- Conversational AI interface
- CBT tools
- Crisis resources
- Pro-only access check
- Voice input option (future)

### **Tab 3: ğŸ  Home** (Default Landing - Center Position)
**Status: âœ… REDESIGNED - Recovery-Focused**

**New Design Philosophy:**
- Focus on recovery outcomes (sobriety days), not perfection (streaks)
- Clean, uncluttered, encouraging
- Every interaction offers support
- AI-integrated for intelligent responses

**Features:**
- âœ… **Real-time sobriety counter** (main focus)
  - Counts months, days, hours, minutes, seconds
  - Updates every second
  - Swipeable for multiple trackers
  - Milestone badges (1 day, 1 week, 1 month, 90 days, 1 year)
  - Background visuals (Bridge/Phoenix/Mountain) - coming

- âœ… **Contextual mood check-in**
  - 4 mood buttons (ğŸ˜¢ Struggling, ğŸ˜ Okay, ğŸ˜Š Good, ğŸš€ Great)
  - Slide-down prompt for optional note
  - Smart prompts based on mood selected
  - Crisis intervention for "Struggling" patterns
  - Last check-in indicator

- âœ… **Simplified motivational quote**
  - 5 short, impactful quotes
  - Rotates daily
  - Small, non-intrusive

**Removed (Intentionally):**
- âŒ Check-in streaks - Too stressful, punishes missed days
- âŒ Sessions joined stat - Belongs in Progress page
- âŒ Manual tracker creation - AI handles this
- âŒ Reset button - AI-guarded for safety
- âŒ Quick action buttons - Reduces clutter

**Why This Works:**
- Focuses on what matters: sobriety time
- Removes pressure and guilt
- Encourages without demanding
- Supports at critical moments
- Clean, peaceful interface

### **Tab 4: ğŸ“… Sessions** (Current Dashboard)
**Status: âœ… Already Exists**
- Browse live & upcoming sessions
- Create new session
- Request to join
- Search & filter
- Real-time updates

### **Tab 5: ğŸ‘¤ Me** (Profile)
**Status: âœ… Already Exists**
- Profile & settings
- Notifications
- Upgrade to Pro (placeholder)
- Help & support

---

## Crisis Detection System

### **Comprehensive Keywords (60+)**

**Critical (Immediate Danger):**
- Suicide, kill myself, end it all, overdose
- Jump off, hang myself, gun to my head
- Hurt my child, harm my baby

**High (Serious Concern):**
- Self harm, cutting, hurt myself
- Using again, bought drugs, going to use
- Voices telling me, hallucinating

**Moderate (Elevated Risk):**
- No hope, hopeless, can't go on
- Panic attack, can't breathe
- Giving up, why bother

### **Response System**

**Critical:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ†˜ We're Concerned About You       â”‚
â”‚                                     â”‚
â”‚  ğŸ“ 988 Suicide & Crisis Lifeline   â”‚
â”‚      [Call Now]                     â”‚
â”‚                                     â”‚
â”‚  ğŸ“± Text HOME to 741741             â”‚
â”‚      [Open Messages]                â”‚
â”‚                                     â”‚
â”‚  ğŸš¨ Emergency: 911                  â”‚
â”‚      [Call Now]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Logging:**
- All crisis events logged
- Admin dashboard for review
- Severity levels tracked
- Future: Real-time admin alerts

---

## Implementation Timeline

### **Week 1-2: Planning & Design**
- [x] Strategic planning
- [x] Feature decisions
- [x] 5-tab navigation structure
- [x] User flows
- [x] Database schema for check-ins

### **Week 3-4: UI Redesign** âœ… COMPLETED
- [x] 5-tab bottom navigation (Progress | Harthio | Home | Sessions | Me)
- [x] Home page with daily quotes
- [x] Progress page structure
- [x] Mobile responsive testing
- [x] Recovery tracker visualization with charts
- [x] Real data integration

### **Week 5-6: Core Features & Data Integration** âœ… COMPLETED
- [x] Daily check-ins (functional)
- [x] Connect real session history to Progress page
- [x] Recovery tracker with real data
- [x] Check-in streak calculation (removed - too stressful)
- [x] Weekly stats implementation
- [x] Real-time sobriety counter
- [x] Multiple tracker support
- [x] Contextual check-in design
- [x] Security hardening (all APIs)

### **Week 7-8: AI Integration** â† WE ARE HERE
- [ ] DeepSeek API setup
- [ ] Harthio AI chat interface (core feature)
- [ ] Contextual check-in with slide-down note input
- [ ] AI-powered tracker creation
- [ ] AI-guarded tracker reset (crisis intervention)
- [ ] Pattern detection & proactive support
- [ ] Rate limiting system (Pro tier)
- [ ] Cost monitoring

### **Week 7-8: AI Integration**
- [ ] DeepSeek API setup
- [ ] Harthio AI chat interface
- [ ] Rate limiting system (1/day free, 10/day pro)
- [ ] Cost monitoring
- [ ] Crisis detection integration

### **Week 9-10: Testing**
- [ ] Beta with 10 users
- [ ] Bug fixes
- [ ] Performance optimization
- [ ] Security review

### **Week 11-12: Launch**
- [ ] Deploy to production
- [ ] Announce to 40 users
- [ ] Monitor & iterate
- [ ] Marketing campaign

---

## Success Metrics

### **Activation**
- âœ… 80% try Harthio AI
- âœ… 50% use weekly
- âœ… 3 interactions/user/week

### **Engagement**
- âœ… 60% daily check-ins
- âœ… 40% use CBT tools
- âœ… 70% view tracker

### **Conversion**
- âœ… 10% convert to Pro
- âœ… 50 Pro users = $500/month
- âœ… <$100/month AI costs

### **Growth**
- âœ… 500 users by end Q1
- âœ… 12.5x from current 40
- âœ… 30% month-over-month

### **Recovery Outcomes** ğŸ’™
- âœ… Users feel supported
- âœ… Crisis interventions work
- âœ… Sobriety days increasing
- âœ… Lives positively impacted

---

## Technical Stack

**Frontend:**
- Next.js 14 (current)
- React Native (mobile apps)
- Tailwind CSS
- Mobile-first responsive

**Backend:**
- Supabase (PostgreSQL)
- DeepSeek API (AI)
- Real-time subscriptions
- WebRTC (video)

**AI Infrastructure:**
- DeepSeek V2 API only
- Rate limiting (1/day free, 10/day pro for topic helper)
- Response caching (1 hour)
- Budget cap: $5/day

---

## Safety & Compliance

### **Age Verification**
- Required for addiction features
- 18+ for addiction recovery
- 13+ for general mental health (with consent)
- Collect date of birth

### **Data Privacy**
- Encrypt all AI conversations
- Users can delete history
- No AI training on user data
- HIPAA-aware (not compliant yet)

### **Crisis Logging**
- All events logged for admin
- Severity levels tracked
- Admin dashboard review
- Future: Real-time alerts

---

## AI Integration Architecture

### **Contextual Check-In Flow**
```
User clicks mood â†’ 
  Slide-down animation (0.3s) â†’
  Smart prompt based on mood â†’
  Optional text input â†’
  Save mood + note â†’
  AI analyzes for patterns â†’
  Slide up animation
```

### **Crisis Detection & Intervention**
```
Struggling mood 3 days in a row â†’
  AI proactively reaches out â†’
  "I noticed you've been struggling. Want to talk?" â†’
  Offers: Talk to AI | Find session | Crisis resources
```

### **AI-Guarded Actions**
```
Critical actions (tracker reset, account deletion) â†’
  Redirect to Harthio AI â†’
  Conversation-based intervention â†’
  Support options offered â†’
  Action only after conversation
```

### **Pattern Detection**
```
AI has access to:
- Check-in history + notes
- Sobriety tracker data
- Mood patterns
- Session participation
- Crisis keywords

AI can:
- Detect patterns ("You feel struggling every Monday")
- Suggest interventions ("Want to schedule a Monday session?")
- Celebrate wins ("30 days! Remember when you said...")
- Provide context-aware support
```

---

## Next Immediate Actions

1. âœ… **Home page redesign** - COMPLETED
2. âœ… **Progress page with stats** - COMPLETED
3. âœ… **Security hardening** - COMPLETED
4. â³ **Contextual check-in UI** - NEXT
5. â³ **Harthio AI chat interface** - CORE FEATURE
6. â³ **AI-powered features** - Integration
7. â³ **Crisis detection system** - Safety critical

---

**Status:** âœ… Week 5-6 complete! Moving to AI integration phase.

**Remember:** We're building a recovery platform that saves lives. Every feature serves that mission. Every interaction offers support. No cold features - everything is human-centered and compassionate.
